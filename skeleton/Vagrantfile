# -*- mode: ruby -*-
# vi: set ft=ruby :
# Generated by zenias_template v $Z_VERSION

#-------------------------------------------------------------------------------
# Vagrant configuration file for a zenias box.
#-------------------------------------------------------------------------------
Vagrant.configure('2') do |config|
  # Box version
  config.vm.box = 'minimal/trusty64'

  # Host name
  config.vm.hostname = 'fcc-vagrant-$Z_LANG'

  # Network config
  # --------------
  
  # Host IP adress. Usefull as we have a server running here.
  #config.vm.network :private_network, ip: '192.168.56.101'
  
  # Binding ports, so you can still access with localhost:<port>
  #config.vm.network :forwarded_port, guest: 80, host: 8080, auto_correct: true
  #config.vm.network :forwarded_port, guest: 5432, host: 5434, auto_correct:true

  # VirtualBox config
  # -----------------
  # You can modify the amount of memory allocated to the guest. Default is 512 Mb
  config.vm.provider :virtualbox do |vb|
    vb.customize ['modifyvm', :id, '--memory', '512']
  end

  # Shared folder.
  # ---------------
  # By default, this folder will be accessible in the machine at /vagrant
  config.vm.synced_folder '.', '/vagrant',
                          # Setting owner and group to vagrant user
                          # This will avoid permissions issues
                          owner: 'vagrant',
                          group: 'vagrant',
                          # Default file mode for this folder's content (in the guest)
                          mount_options: ['dmode=775', 'fmode=774']

  # ------------------------
  # That's all for this file
  # ------------------------

  # https://github.com/fgrehm/vagrant-cachier
  # This will reduce provision time with cached packages, shared between machines.
  if Vagrant.has_plugin?('vagrant-cachier')
    machine_id.cache.scope = :box
  end

  # Add the tty fix as mentioned in issue 1673 on vagrant repo
  # To avoid 'stdin is not a tty' messages
  # vagrant provisioning in shell runs bash -l
  config.vm.provision "fix-no-tty", type: "shell" do |s|
      s.privileged = false
      s.inline = "sudo sed -i '/tty/!s/mesg n/tty -s \\&\\& mesg n/' /root/.profile"
  end

  # Provision script
  config.vm.provision :shell, path: './vagrant/provision.sh'
end
